{% extends "style/base_perfil.html" %}
{% load static %}

{% block title %}{{ pet.nome }} ‚Äî Pet | Amigo Fiel{% endblock %}

{% block extra_head %}
<style>
  /* pequenininha para a ‚Äútabelinha‚Äù de informa√ß√µes */
  .dl{list-style:none;margin:0;padding:0}
  .dl li{display:flex;justify-content:space-between;gap:12px;padding:6px 0;border-bottom:1px dashed #e9edf3}
  .dl li:last-child{border-bottom:none}
  .dl span{color:var(--af-muted,#64748b)}
</style>
{% endblock %}

{# imagem/‚Äúavatar‚Äù do pet no cabe√ßalho do base_perfil #}
{% block avatar %}
  <img class="avatar"
       src="{% if pet.imagem %}{{ pet.imagem.url }}{% else %}{% static 'img/defaults/pet.png' %}{% endif %}"
       alt="{{ pet.nome }}">
{% endblock %}

{% block perfil_name %}{{ pet.nome }}{% endblock %}
{% block perfil_handle %}@{{ pet.slug }}{% endblock %}
{% block perfil_meta %}
  {{ pet.get_especie_display }}
  {% if pet.raca %} ‚Ä¢ {{ pet.raca }}{% endif %}
  {% if pet.idade_anos %} ‚Ä¢ {{ pet.idade_anos }} ano{{ pet.idade_anos|pluralize }}{% endif %}
  {% if pet.sexo %} ‚Ä¢ {{ pet.get_sexo_display|default:pet.sexo|capfirst }}{% endif %}
{% endblock %}

{% block perfil_actions %}
  <div class="actions" style="gap:8px;flex-wrap:wrap;">
    {% if pet.ong %}
      {% if pet.ong.user.email %}
        <a class="btn btn-primary"
           href="mailto:{{ pet.ong.user.email }}?subject=Interesse%20em%20adotar%20{{ pet.nome }}">
          Falar com a ONG
        </a>
      {% endif %}
      <a class="btn btn-secondary"
         href="{% url 'amigofiel:perfil-ong' handle=pet.ong.user.username %}">
        Ver ONG
      </a>
    {% elif pet.tutor %}
      {% if pet.tutor.user.email %}
        <a class="btn btn-primary"
           href="mailto:{{ pet.tutor.user.email }}?subject=Interesse%20em%20{{ pet.nome }}">
          Falar com o tutor
        </a>
      {% endif %}
      <a class="btn btn-secondary"
         href="{% url 'amigofiel:perfil-usuario' handle=pet.tutor.user.username %}">
        Ver perfil do tutor
      </a>
    {% endif %}

    {% if not pet.adotado %}
      <a class="btn btn-accent"
         href="{% url 'amigofiel:listar-animais' %}?q={{ pet.nome|urlencode }}">
        Quero adotar
      </a>
    {% endif %}
  </div>
{% endblock %}

{% block body %}
  <section class="grid" style="align-items:start;">
    <!-- bloco de informa√ß√µes r√°pidas -->
    <article class="mini-card">
      <h2 style="margin:0 0 8px;">Informa√ß√µes</h2>
      <ul class="dl">
        <li><span>Esp√©cie</span><strong>{{ pet.get_especie_display }}</strong></li>
        {% if pet.raca %}<li><span>Ra√ßa</span><strong>{{ pet.raca }}</strong></li>{% endif %}
        {% if pet.sexo %}<li><span>Sexo</span><strong>{{ pet.get_sexo_display|default:pet.sexo|capfirst }}</strong></li>{% endif %}
        {% if pet.idade_anos %}<li><span>Idade</span><strong>{{ pet.idade_anos }} ano{{ pet.idade_anos|pluralize }}</strong></li>{% endif %}
        <li>
          <span>Sa√∫de</span>
          <strong>
            {% if pet.castrado %}‚úÇÔ∏è Castrado{% endif %}
            {% if pet.castrado and pet.vacinado %} ‚Ä¢ {% endif %}
            {% if pet.vacinado %}üíâ Vacinado{% endif %}
            {% if not pet.castrado and not pet.vacinado %}‚Äî{% endif %}
          </strong>
        </li>
        <li>
          <span>Status</span>
          <strong>{% if pet.adotado %}Adotado{% else %}Dispon√≠vel{% endif %}</strong>
        </li>
        <li>
          <span>Cidade</span>
          <strong>
            {% if pet.tutor and pet.tutor.cidade %}{{ pet.tutor.cidade }}
            {% elif pet.ong and pet.ong.cidade %}{{ pet.ong.cidade }}
            {% else %}‚Äî{% endif %}
          </strong>
        </li>
        <li>
          <span>Respons√°vel</span>
          <strong>
            {% if pet.ong %}ONG {{ pet.ong.nome_fantasia }}
            {% elif pet.tutor %}@{{ pet.tutor.user.username }}
            {% else %}‚Äî{% endif %}
          </strong>
        </li>
      </ul>
    </article>

    <!-- descri√ß√£o -->
    <article class="mini-card">
      <h2 style="margin:0 0 8px;">Sobre o {{ pet.nome }}</h2>
      {% if pet.descricao %}
        <p class="muted" style="white-space:pre-line">{{ pet.descricao }}</p>
      {% else %}
        <p class="muted">Sem descri√ß√£o fornecida.</p>
      {% endif %}
    </article>

    <!-- galeria (mant√©m espa√ßo para no futuro ter mais imagens) -->
    <article class="mini-card" style="grid-column:1/-1;">
      <h2 style="margin:0 0 8px;">Galeria</h2>
      <div class="grid grid-1 grid-md-2 grid-lg-3">
        <img class="thumb"
             src="{% if pet.imagem %}{{ pet.imagem.url }}{% else %}{% static 'img/defaults/pet.png' %}{% endif %}"
             alt="{{ pet.nome }}">
      </div>
    </article>
  </section>
{% endblock %}
