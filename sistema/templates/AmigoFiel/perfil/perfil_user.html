{% extends "style/base_perfil.html" %}
{% load static %}

{% block title %}{{ perfil.user.get_full_name|default:perfil.user.username }} — Perfil{% endblock %}

{% block avatar %}
  <img class="avatar"
       src="{% if perfil.foto %}{{ perfil.foto.url }}{% else %}{% static 'img/defaults/avatar_comum.png' %}{% endif %}"
       alt="Foto de {{ perfil.user.username }}">
{% endblock %}

{% block perfil_name %}{{ perfil.user.get_full_name|default:perfil.user.username }}{% endblock %}
{% block perfil_handle %}@{{ perfil.user.username }}{% endblock %}
{% block perfil_meta %}
  {% if perfil.cidade %}🏙️ {{ perfil.cidade }} · {% endif %}
  Usuário comum
{% endblock %}

{% block perfil_actions %}
  {% if perfil.user.email %}
    <a class="btn btn-primary"
       href="mailto:{{ perfil.user.email }}?subject=Contato%20-%20Amigo%20Fiel">Contato</a>
  {% endif %}
{% endblock %}

{% block body %}
  <section class="grid">
    <article class="mini-card">
      <h2>Informações</h2>
      <p><strong>Usuário:</strong> @{{ perfil.user.username }}</p>
      {% if perfil.cidade %}<p><strong>Cidade:</strong> {{ perfil.cidade }}</p>{% endif %}
      {% if perfil.telefone %}<p><strong>Telefone:</strong> {{ perfil.telefone }}</p>{% endif %}
      {% if perfil.user.email %}<p><strong>E-mail:</strong> {{ perfil.user.email }}</p>{% endif %}
    </article>

    <article class="mini-card" style="grid-column:1/-1">
      <div class="perfil-section-header">
        <h2>Pets</h2>
        <small class="muted">Últimos cadastrados</small>
      </div>
      {% if pets %}
        <div class="grid grid-1 grid-md-2 grid-lg-4">
          {% for p in pets %}
            <a class="card-link" href="{% url 'amigofiel:perfil-pet' handle=p.slug %}">
              <article class="mini-card">
                <img class="thumb"
                     src="{% if p.imagem %}{{ p.imagem.url }}{% else %}{% static 'img/defaults/pet.png' %}{% endif %}"
                     alt="{{ p.nome }}">
                <h3>{{ p.nome }}</h3>
                <p class="muted">{{ p.get_especie_display }}{% if p.raca %} • {{ p.raca }}{% endif %}</p>
              </article>
            </a>
          {% endfor %}
        </div>
      {% else %}
        <p class="muted">Nenhum pet listado.</p>
      {% endif %}
    </article>
  </section>
{% endblock %}
