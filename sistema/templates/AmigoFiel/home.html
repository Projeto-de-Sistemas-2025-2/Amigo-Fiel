{% extends "style/base_public.html" %}
{% load static %}

{% block title %}Amigo Fiel — adoção responsável{% endblock %}

{% block extra_head %}
<style>
  /* ==== Banner rotativo (carrossel) ==== */
  .carousel {
    position: relative;
    border-radius: 14px;
    overflow: hidden;
    background: var(--bg-elev);
    box-shadow: var(--shadow);
  }
  .carousel__track {
    display: grid;
    grid-auto-flow: column;
    grid-auto-columns: 100%;
    overflow-x: auto;
    scroll-snap-type: x mandatory;
    scrollbar-width: none;
  }
  .carousel__track::-webkit-scrollbar{ display:none; }
  .carousel__item {
    scroll-snap-align: start;
    height: clamp(180px, 32vw, 360px);
    display:grid; place-items:center;
    background: var(--brand-100);
  }
  .carousel__item img{
    width:100%; height:100%; object-fit:cover;
  }
  .carousel__nav{
    position:absolute; inset:0; display:flex; justify-content:space-between; align-items:center; pointer-events:none;
  }
  .carousel__btn{
    pointer-events:auto;
    display:grid; place-items:center;
    width:44px; height:44px; border-radius:50%;
    background: rgba(0,0,0,.55); color:#fff; border:none;
    margin:0 8px; cursor:pointer;
  }

  /* ==== Quadros “veja também” (4 colunas) ==== */
  .home-strips{ display:grid; gap:14px; grid-template-columns:repeat(4,1fr); }
  @media (max-width:1100px){ .home-strips{ grid-template-columns:repeat(2,1fr);} }
  @media (max-width:640px){ .home-strips{ grid-template-columns:1fr; } }

  .mini-board{
    background:#fff; border-radius:14px; padding:12px; box-shadow:var(--shadow);
  }
  .mini-board h3{ margin:0 0 10px; font-size:16px; }
  .mini-board__grid{
    display:grid; grid-template-columns:repeat(2,1fr); gap:10px;
  }
  .mini-tile{
    display:block; text-decoration:none; color:inherit;
    border-radius:12px; padding:8px; background:var(--bg-elev);
    transition:transform .12s ease;
  }
  .mini-tile:hover{ transform:translateY(-2px); }
  .mini-tile img{
    width:100%; aspect-ratio:1/1; object-fit:cover; border-radius:10px;
    background: #eef2f5;
  }
  .mini-tile .label{ display:block; margin-top:6px; font-size:12px; line-height:1.2; }

  /* ==== Bloco vídeo + banner adoção ==== */
  .home-duo{ display:grid; gap:14px; grid-template-columns:1fr 1fr; }
  @media (max-width:900px){ .home-duo{ grid-template-columns:1fr; } }
  .card-hero{
    background:#fff; border-radius:14px; padding:16px; box-shadow:var(--shadow);
    display:grid; gap:10px; align-content:center; min-height:240px;
  }

  /* ==== Faixa de categorias ==== */
  .cats-strip{
    background:#fff; border-radius:14px; box-shadow:var(--shadow); padding:10px 6px;
  }
  .cats-row{
    display:flex; align-items:center; gap:10px;
    overflow-x:auto; scrollbar-width:none;
  }
  .cat-pill{
    display:inline-flex; align-items:center; justify-content:center;
    min-width:100px; height:44px; padding:0 16px; border-radius:999px;
    background: var(--brand-50);
    color: var(--brand-700);
    text-decoration:none; font-weight:600;
    white-space:nowrap;
  }
  .strip-title{ font-weight:700; margin:0 0 8px 10px; }
</style>
{% endblock %}

{% block body %}

  <!-- ====== BANNER ROTATIVO ====== -->
  <section class="carousel" aria-label="Destaques">
    <div class="carousel__track" id="heroTrack">
      <!-- substitua as imagens conforme quiser -->
      <a class="carousel__item" href="{% url 'amigofiel:listar-animais' %}">
        <img src="{% static 'img/banners/homepage_promocionais/Dicas.png' %}" alt="Adote com responsabilidade">
      </a>
      <a class="carousel__item" href="{% url 'amigofiel:listar-produtos' %}">
        <img src="{% static 'img/banners/homepage_promocionais/Procura-se.png' %}" alt="Produtos para o seu pet">
      </a>
      <a class="carousel__item" href="{% url 'amigofiel:listar-ongs' %}">
        <img src="{% static 'img/banners/homepage_promocionais/Vacina.png' %}" alt="Conheça ONGs parceiras">
      </a>
    </div>
    <div class="carousel__nav">
      <button class="carousel__btn" data-slide="prev" aria-label="Anterior">❮</button>
      <button class="carousel__btn" data-slide="next" aria-label="Próximo">❯</button>
    </div>
  </section>

  <!-- ====== 4 QUADROS “VEJA TAMBÉM” ====== -->
  <section class="home-strips" style="margin-top:16px">
    <!-- PETS -->
    <article class="mini-board">
      <h3>Veja também esses Pets</h3>
      <div class="mini-board__grid">
        {% for p in pets_destaque|default:destaques|slice:":4" %}
          <a class="mini-tile"
             {% if p.slug %}href="{% url 'amigofiel:perfil-pet' handle=p.slug %}"{% else %}
                href="{% url 'amigofiel:listar-animais' %}?q={{ p.nome|urlencode }}"{% endif %}>
            <img src="{% if p.imagem %}{{ p.imagem.url }}{% else %}{% static 'img/defaults/pet.png' %}{% endif %}"
                 alt="{{ p.nome }}">
            <span class="label">{{ p.nome }}</span>
          </a>
        {% empty %}
          <div class="muted">Sem pets ainda.</div>
        {% endfor %}
      </div>
    </article>

    <!-- PRODUTOS -->
    <article class="mini-board">
      <h3>Veja também esses Produtos</h3>
      <div class="mini-board__grid">
        {% for pr in produtos_destaque|slice:":4" %}
          <a class="mini-tile"
             {% if pr.slug %}href="{% url 'amigofiel:produto-detalhe' empresa_handle=pr.empresa.user.username produto_slug=pr.slug %}"{% else %}
                href="{% url 'amigofiel:listar-produtos' %}?q={{ pr.nome|urlencode }}"{% endif %}>
            <img src="{% if pr.imagem %}{{ pr.imagem.url }}{% else %}{% static 'img/defaults/produto.png' %}{% endif %}"
                 alt="{{ pr.nome }}">
            <span class="label">{{ pr.nome }}</span>
          </a>
        {% empty %}
          <div class="muted">Sem produtos ainda.</div>
        {% endfor %}
      </div>
    </article>

    <!-- LOJAS -->
    <article class="mini-board">
      <h3>Veja também essas Lojas</h3>
      <div class="mini-board__grid">
        {% for lo in lojas_destaque|slice:":4" %}
          <a class="mini-tile" href="{% url 'amigofiel:perfil-empresa' handle=lo.user.username %}">
            <img src="{% if lo.foto %}{{ lo.foto.url }}{% else %}{% static 'img/defaults/avatar_empresa.png' %}{% endif %}"
                 alt="{{ lo.razao_social }}">
            <span class="label">{{ lo.razao_social }}</span>
          </a>
        {% empty %}
          <div class="muted">Sem lojas ainda.</div>
        {% endfor %}
      </div>
    </article>

    <!-- ONGs -->
    <article class="mini-board">
      <h3>Veja também essas ONGs</h3>
      <div class="mini-board__grid">
        {% for og in ongs_destaque|slice:":4" %}
          <a class="mini-tile" href="{% url 'amigofiel:perfil-ong' handle=og.user.username %}">
            <img src="{% if og.foto %}{{ og.foto.url }}{% else %}{% static 'img/defaults/avatar_ong.png' %}{% endif %}"
                 alt="{{ og.nome_fantasia }}">
            <span class="label">{{ og.nome_fantasia }}</span>
          </a>
        {% empty %}
          <div class="muted">Sem ONGs ainda.</div>
        {% endfor %}
      </div>
    </article>
  </section>

  <!-- ====== VÍDEO + BANNER ADOÇÃO ====== -->
  <section class="home-duo" style="margin-top:16px;">
    <!-- Vídeo (YouTube) -->
    <article class="card-hero">
      <h3 class="h4" style="margin:0;">Como adotar com responsabilidade</h3>
          <iframe
            title="Adote com responsabilidade"
            width="100%" height="280" style="aspect-ratio:16/9; width:100%; height:auto; display:block;"
            src="https://www.youtube.com/embed/f4Rg3GxqCx0"
            frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
            allowfullscreen></iframe>
      </div>
    </article>

    <!-- Banner -->
    <article class="card-hero">
      <h3 class="h3" style="margin:0;">Adotar muda duas vidas</h3>
      <p class="muted" style="margin:0">
        Conheça histórias inspiradoras e encontre seu amigo fiel. Veja pets próximos à sua cidade
        e converse com ONGs/protetores pela plataforma.
      </p>
      <div>
        <a class="btn btn-primary" href="{% url 'amigofiel:listar-animais' %}">Quero adotar</a>
        <a class="btn btn-secondary" href="{% url 'amigofiel:listar-ongs' %}">Ver ONGs</a>
      </div>
    </article>
  </section>

  <!-- ====== CATEGORIAS DE PRODUTOS ======
  <section class="cats-strip" style="margin-top:16px;">
    <h3 class="strip-title">Navegue pelas categorias</h3>
    <div class="cats-row" aria-label="Categorias">
      {% if categorias_produto %}
        {% for c in categorias_produto %}
          <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria={{ c.slug|urlencode }}">{{ c.nome }}</a>
        {% endfor %}
      {% else %}
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=racao">Ração</a>
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=brinquedos">Brinquedos</a>
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=roupas">Roupas</a>
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=farmacia">Farmácia</a>
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=higiene">Higiene</a>
        <a class="cat-pill" href="{% url 'amigofiel:listar-produtos' %}?categoria=banho-tosa">Banho &amp; Tosa</a>
      {% endif %}
    </div>
  </section> -->

{% endblock %}

{% block extra_js %}
<script>
  (function(){
    const track = document.getElementById('heroTrack');
    const btnPrev = document.querySelector('[data-slide="prev"]');
    const btnNext = document.querySelector('[data-slide="next"]');
    const items = track.querySelectorAll('.carousel__item');
    let current = 0;

    function slide(dir){
      current += dir;
      if(current < 0) current = items.length - 1;
      if(current >= items.length) current = 0;
      items[current].scrollIntoView({behavior:'smooth', inline:'start'});
    }
    btnPrev.addEventListener('click', ()=>slide(-1));
    btnNext.addEventListener('click', ()=>slide(1));

    let timer = setInterval(()=>slide(1), 6000);
    track.addEventListener('pointerdown', ()=>clearInterval(timer), {once:true});
  }());
</script>
{% endblock %}
